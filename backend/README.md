# Surprise Me Friday - Backend

FastAPI backend service for the Surprise Me Friday feature. This service handles AI-powered meal recommendations based on user preferences.

## Features

- **Recommendation API**: Generates personalized meal recommendations
- **Mock Data**: Includes sample restaurant and dish data for testing
- **Simple Algorithm**: Scores dishes based on user mood and preferences
- **API Documentation**: Automatic OpenAPI documentation via FastAPI

## Setup

### Prerequisites
- Python 3.8+
- pip

### Installation

1. Create a virtual environment:
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

### Running the server

```bash
python app.py
```

The server will start at http://localhost:8000

API documentation will be available at:
- http://localhost:8000/docs (Swagger UI)
- http://localhost:8000/redoc (ReDoc)

## API Endpoints

### GET /api/health
Health check endpoint to verify the API is running.

**Response:**
```json
{
  "status": "healthy",
  "timestamp": "2025-03-20T12:34:56.789012"
}
```

### POST /api/recommendations
Get meal recommendations based on user preferences.

**Request Body:**
```json
{
  "vibe": "comfort",
  "craving": "savory",
  "restrictions": ["vegetarian"]
}
```

**Parameters:**
- `vibe` (string): User's current mood/vibe (comfort, healthy, adventurous, quick, celebration)
- `craving` (string): Specific food craving (none, savory, sweet, spicy, fresh)
- `restrictions` (array): Dietary restrictions (vegetarian, vegan, gluten-free, dairy-free, nut-free, none)
- `shuffle` (query parameter, boolean): Whether to return alternative recommendations

**Response:**
```json
{
  "recommendations": [
    {
      "id": 502,
      "name": "Margherita Pizza",
      "price": "$14.99",
      "description": "Classic pizza with fresh mozzarella, tomato sauce, and basil on a thin, crispy crust.",
      "restaurant": "Pizza Palace",
      "cuisine": "Italian",
      "rating": 4.5,
      "deliveryTime": 30,
      "matchPercentage": 92,
      "matchReasons": ["Matches your comfort food mood", "Satisfies your savory craving"]
    },
    {
      "id": 202,
      "name": "Mediterranean Wrap",
      "price": "$12.99",
      "description": "Hummus, falafel, cucumber, tomato, and tzatziki wrapped in a whole wheat tortilla.",
      "restaurant": "Green Garden",
      "cuisine": "Vegetarian",
      "rating": 4.8,
      "deliveryTime": 30,
      "matchPercentage": 87,
      "matchReasons": ["Satisfies your savory craving"]
    }
  ]
}
```

## Recommendation Algorithm

The current implementation uses a simple scoring system:

1. **Vibe Matching**: +30 points for dishes matching the user's selected vibe
2. **Craving Matching**: +20 points for dishes matching the user's craving
3. **Dietary Restrictions**: -100 points for dishes that don't meet dietary requirements
4. **Random Factor**: Small random factor to prevent identical recommendations
5. **Sorting**: Dishes are sorted by total score, and the top 1-2 are returned

## Mock Data

The backend uses a JSON file (`mock_data.json`) to simulate restaurant and dish data. This file is automatically generated if it doesn't exist.

## Future Improvements

1. **Machine Learning Model**: Replace the simple scoring system with a trained model
2. **User History**: Incorporate past order history into recommendations
3. **Contextual Factors**: Consider time of day, weather, and seasonal trends
4. **Performance Optimization**: Add caching for frequently requested recommendations
5. **Database Integration**: Replace mock data with a real database

## Error Handling

The API returns appropriate HTTP status codes:
- 200: Successful response
- 404: No suitable recommendations found
- 500: Server error